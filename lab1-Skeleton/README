There's a couple memory leaks, when we hit invalid syntax and exit,
other than that, it passes the test cases.
